# 有限状態マシン（FSM）Mode 3の実装

このディレクトリには有限状態マシン（Finite State Machine）のMode 3実装が含まれています。これはゲームAIのための柔軟でパワフルな状態管理システムです。

## 主な特徴

Mode 3の実装は以下の特徴を持っています：

1. **階層型FSM**: 親子関係を持つステートマシンをサポートし、複雑な行動をモデル化できます
2. **イベント駆動型**: 外部イベントによる状態遷移をサポート
3. **条件付き自動遷移**: 条件が満たされると自動的に状態遷移が発生

## 主要なコンポーネント

- `IState` インターフェース: すべての状態クラスが実装する必要があるインターフェース
- `StateMachine` クラス: FSMの主要ロジックを含むクラス
- サンプル状態クラス: `IdleState`、`PatrolState`、`ChaseState`など

## 使用方法

```csharp
// エンティティ作成
Entity enemy = new Entity("Enemy", new Vector2(100, 100));

// エンティティを更新
void Update(GameTime gameTime)
{
    enemy.Update(gameTime);
}

// イベントのトリガー
enemy.TriggerEvent("PlayerDetected");
```

## FSMの仕組み

1. **初期化**: 状態を追加し、初期状態を設定
2. **更新**: 現在の状態の`Update`メソッドを呼び出し
3. **遷移**: イベントまたは条件に基づいて状態間を遷移

## 状態遷移

状態遷移は次の2つの方法で発生します：

1. **イベント駆動**: `TriggerEvent`メソッドを呼び出すことで発生
2. **自動遷移**: 更新サイクル中に条件が満たされると発生

## 階層型FSMの利点

- コードの再利用性の向上
- 複雑な行動の簡素化
- より明確な状態管理構造

## 実装の詳細

### StateMachine.cs
FSMの主要なロジックを含むクラス。状態の追加、遷移の設定、イベントの処理を担当。

### ExampleState.cs
FSMの使用例を示すサンプル実装。一般的なゲームAIの状態（アイドル、巡回、追跡）を実装。 